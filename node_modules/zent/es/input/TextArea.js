import { __assign, __rest } from "tslib";
import * as React from 'react';
import cx from 'classnames';
var autosize = require('autosize');
import noop from '../utils/noop';
import { createUseIMEComposition } from '../ime-composition';
var useIMEComposition = createUseIMEComposition();
export var TextArea = React.forwardRef(function (props, ref) {
    var valueProp = props.value, onChangeProp = props.onChange, onCompositionStartProp = props.onCompositionStart, onCompositionEndProp = props.onCompositionEnd, autoSize = props.autoSize, showCount = props.showCount, maxLength = props.maxLength, width = props.width, size = props.size, onPressEnter = props.onPressEnter, autoFocus = props.autoFocus, autoSelect = props.autoSelect, initSelectionStart = props.initSelectionStart, initSelectionEnd = props.initSelectionEnd, inline = props.inline, otherProps = __rest(props, ["value", "onChange", "onCompositionStart", "onCompositionEnd", "autoSize", "showCount", "maxLength", "width", "size", "onPressEnter", "autoFocus", "autoSelect", "initSelectionStart", "initSelectionEnd", "inline"]);
    var _a = useIMEComposition(valueProp, onChangeProp, onCompositionStartProp, onCompositionEndProp), value = _a.value, onChange = _a.onChange, onCompositionStart = _a.onCompositionStart, onCompositionEnd = _a.onCompositionEnd;
    React.useLayoutEffect(function () {
        if (!autoSize) {
            return noop;
        }
        var el = ref.current;
        if (!el) {
            return noop;
        }
        autosize(el);
        return function () {
            autosize.destroy(el);
        };
    }, [autoSize, ref]);
    return (React.createElement(React.Fragment, null,
        React.createElement("textarea", __assign({}, otherProps, { ref: ref, className: cx('zent-textarea', {
                'zent-textarea-with-count': showCount,
            }), value: value, maxLength: maxLength, onChange: onChange, onCompositionStart: onCompositionStart, onCompositionEnd: onCompositionEnd, "data-zv": '7.4.3' })),
        showCount && (React.createElement("span", { className: "zent-textarea-count", "data-zv": '7.4.3' },
            (value || '').length,
            "/",
            maxLength))));
});
TextArea.displayName = 'TextArea';
